<!DOCTYPE HTML>
<html>
<head>
    <title>Reminiscens</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="css/jquery.fileupload-ui.css">
    <link href="css/StyleOverlay.css" rel="stylesheet">
    <link href="kendo/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="kendo/styles/kendo.default.min.css" rel="stylesheet" />    

    <!-- Add fancyBox -->
    <link rel="stylesheet" href="fancybox/source/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />

    <!-- Optionally add helpers - button, thumbnail and/or media -->
    <link rel="stylesheet" href="fancybox/source/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen" />
    <link rel="stylesheet" href="fancybox/source/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen" />
    <link rel="stylesheet" href="decade-ruler/decade-ruler.css">
 
    <!-- moved all javascript to the bottom to improve rendering of page -->
    
    <!-- All the javascript code is below this -->
     
    <script type="text/javascript" src="phonegap.js"></script>
    <script src="js/libs/jquery.js"></script>
    <script src="js/libs/bootstrap.js"></script>
    <script src="js/GestioneOverlay.js"></script>
    <script src="kendo/js/kendo.web.min.js"></script>
    <!-- Uncomment this and GestioneRecorderHTML for deplowing in web server 
<script type="text/javascript" src="js/recorder.js"></script>
-->
    <script type="text/javascript" src="js/GestioneKendoEditor.js"></script>
    <script type="text/javascript" src="js/GestioneFoto.js"></script>
    <script type="text/javascript" src="js/GestioneAudio.js"></script>

    <!-- <script type="text/javascript" src="js/GestioneRecorderHTML.js"></script> 
-->
    <script type="text/javascript" src="js/libs/jquery.storageapi.js"></script>
    <script type="text/javascript" src="js/libs/jquery.cookie.js"></script>
    <script type="text/javascript" src="js/libs/json2.js"></script>
    <script type="text/javascript" src="js/GestioneImmagini.js"></script>
    <script type="text/javascript" src="js/SaveStoryJSON.js"></script>

    <!-- Add mousewheel plugin (this is optional) -->
    <script type="text/javascript" src="fancybox/lib/jquery.mousewheel-3.0.6.pack.js"></script>

    <!-- Add fancyBox -->
    <script type="text/javascript" src="fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

    <!-- Optionally add helpers - button, thumbnail and/or media -->
    <script type="text/javascript" src="fancybox/source/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
    <script type="text/javascript" src="fancybox/source/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
     
      <script type="text/javascript" src="fancybox/source/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>

    <!-- Add jQuery library -->
    <!--<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>-->

    <script type="text/javascript" src="js/sha1.js"></script>
    <script type="text/javascript" src="js/GestioneSchermate&Menu.js"></script>
    <script type="text/javascript" src="js/libs/jquery-ui.js"></script>
    <script type="text/javascript" src="js/GestioneRegistrazione.js"></script>
    <script type="text/javascript" src="js/GestioneSynchronizeStories.js"></script>
    <script type="text/javascript" src="js/app/files.js"></script>
    <!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
    <script type="text/javascript" src="js/lib/jquery.file.upload/js/vendor/jquery.ui.widget.js"></script>
    <!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
    <script type="text/javascript" src="js/lib/jquery.file.upload/js/jquery.iframe-transport.js"></script>
    <!-- The basic File Upload plugin -->
    <script type="text/javascript" src="js/libs/jquery.fileupload.js"></script>
    <script type="text/javascript" src="js/GestioneVariabiliPersona.js"></script>
    <script type="text/javascript" src="js/GestioneQuestion.js"></script>

    <script type="text/javascript" src="js/GestioneContext.js"></script>
    <script type="text/javascript" src="js/GestioneTimeline.js"></script>

    <script type="text/javascript" src="js/dotdotdot-1.6.4/jquery.dotdotdot.js"></script>

    <link href="css/StyleRoot.css" rel="stylesheet" />
    
</head>
<body>
    <div id="divRoot">
        <!--<input class="timeline" id="1940" type="image" src="button/1940.jpg">
<input class="timeline" id="1950" type="image" src="button/1950.jpg">
<input class="timeline" id="1960" type="image" src="button/1960.jpg">
<input class="timeline" id="1970" type="image" src="button/1970.jpg">
<input class="timeline" id="1980" type="image" src="button/1980.jpg">
<input class="timeline" id="1990" type="image" src="button/1990.jpg">-->
        <div id="containerTimelineCarousel">
            
        </div>

            <br />
            <div id="centrale">
                <div id="Caricamento" style="display: none;">
                    <img src="img/caricamento.gif" style="margin-top:100px;" />
                </div>
                <div id="NoResults" style="display: none;">
                    <div style="background-color: #FFF; padding-bottom: 30px; padding-top: 20px;">
                        <label id="lbldebug">Non ci sono ancora storie del 1950!</label>
                    </div>
                    <button style="margin-top: 100px;" id="RaccontaciUnaStoria" class="btn btn-large btn-primary" onclick="ApriOverlay();">Raccontaci una storia</button>
                    <br>

                    <!-- <div class="divFoto" style="height:300px; margin-top:100px; padding-left:5px; padding-right:5px; width:440px;">
                    <h3>Domande sul periodo</h3>
                    <button style="margin-top:40px;" id="FirstDecadeQuestionEmpty" class="btn btn-primary" onClick="ApriOverlay(this.id);"></button>
                    <br>
                    <button style="margin-top:40px;" id="SecondDecadeQuestionEmpty" class="btn btn-primary" onClick="ApriOverlay(this.id);"></button>
                </div>

                <div class="divFoto" style="height:300px;margin-top:100px;padding-left:5px; padding-right:5px;width:440px;">
                    <h3>Domande personali sul periodo</h3>
                    <button style="margin-top:40px;" id="FirstPersonalQuestionEmpty" class="btn btn-primary" onClick="ApriOverlay(this.id);"></button>
                    <br>
                    <button style="margin-top:40px;" id="SecondPersonalQuestionEmpty" class="btn btn-primary" onClick="ApriOverlay(this.id);"></button>
                </div>-->

                    <div id="divFirstDecadeQuestionEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: 150px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="FirstDecadeQuestionEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('FirstDecadeQuestionEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>
                    <div id="divSecondDecadeQuestionEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: 150px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="SecondDecadeQuestionEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('SecondDecadeQuestionEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>

                    <div id="divFirstPersonalQuestionEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: 20px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="FirstPersonalQuestionEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('FirstPersonalQuestionEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>
                    <div id="divSecondPersonalQuestionEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: 20px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="SecondPersonalQuestionEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('SecondPersonalQuestionEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>
                    <button class="btn btn-primary" style="margin-top: 20px;" onclick="Logout();">Esci</button>

                </div>
                <div id="Results" style="display: none;">

                    <div class="navbar">
                        <div class="navbar-inner">
                            <ul class="nav">
                                <li class="active" id="liFoto"><a href="#">Foto</a> </li>
                                <li id="liStorie"><a href="#">Storie</a></li>
                                <li id="liCanzoni"><a href="#">Canzoni</a></li>
                                <li id="liFamosi"><a href="#">Famosi</a></li>
                                <li id="liTvFilm"><a href="#">TV/Film</a></li>
                                <li id="liRaccontaci"><a href="#">Raccontaci</a></li>
                                <li id="liLogout"><a href="#">Esci</a></li>
                                <li id="liRefresh"><a href="#">Aggiorna</a></li>
                            </ul>
                        </div>
                    </div>

                    <div id="divDecadeQuestionNotEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: -16px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="DecadeQuestionNotEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('DecadeQuestionNotEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>
                    <div id="idPersonalQuestionNotEmpty" style="background-color: #CCC; width: 486px; padding: 2px 2px 2px 2px; margin-left: 10px; margin-right: 10px; float: left; margin-top: -16px; height: 80px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;">
                        <span id="PersonalQuestionNotEmpty"></span>
                        <br>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="ApriOverlay('PersonalQuestionNotEmpty');">Raccontaci!</button>
                        <button class="btn btn-primary" style="margin-top: 2px;" onclick="newQuestion();">Altra domanda</button>
                    </div>

                    <div id="Foto">
                        <div id="divRootFotoDelTempo" class="divFoto">
                            <h3 id="FotoDelTempo">Foto pubbliche attorno al 1950</h3>
                            <div id="containerCarouselFotoDelTempo">
                            </div>
                        </div>
                        <div class="divFoto">
                            <h3 id="TueFotoDelTempo">Le tue foto attorno al 1950</h3>

                            <div id="containerCarouselMieFotoDelTempo">

                            </div>
                        </div>
                    </div>
                    <div id="Storie" style="display: none;">
                        <div id="divRootStorieDelTempo" class="divFoto">
                            <h3 id="StorieDelTempo">Che cosa succedeva nel 1950</h3>
                            <div id="containerCarouselStorieDelTempo">

                            </div>
                        </div>
                        <div class="divFoto">
                            <h3 id="TueStorieDelTempo">Le tue storie nel 1950</h3>

                            <div id="containerCarouselMieStorieDelTempo">

                            </div>
                        </div>
                    </div>
                    <div id="Canzoni" style="display: none;">
                        <div class="divCanzoni">

                            <h3 id="CanzoniDelTempo">Le canzoni degli anni 1950</h3>
                            <div id="containerCarouselCanzoniDelTempo">
                            </div>
                        </div>
                    </div>
                    <div id="Famosi" style="display: none;">
                        <div class="divCanzoni">
                            <h3 id="FamosiDelTempo">Chi era famoso/e' nato attorno al 1950</h3>

                            <div id="containerCarouselFamosiDelTempo">

                            </div>
                        </div>
                    </div>
                    <div id="TvFilm" style="display: none;">
                        <div class="divCanzoni">


                            <h3 id="FamosiDelTempo">La TV e i film degli anni 1950</h3>
                            <div id="containerCarouselTVDelTempo">



                            </div>
                        </div>
                    </div>

                </div>
                <div class="overlay" id="overlay" style="display: none;"></div>
                <!--contenuto overlay-->
                <div id="box">
                    <div style="background-color: #D5D5D5; padding-top: 10px;">
                        <div style="background-color: #A05152; padding-bottom: 10px; padding-top: 10px;">
                            <label id="titleBox">raccontaci la tua storia</label>
                            <button id="salva" onclick="salvaStoria();" class="btn btn-primary">Salva</button>
                        </div>
                        <div style="margin-top: 10px; color: #000; margin-left: 20px; margin-right: 20px;">
                            <form>
                                <div>
                                    <label for="titolo" style="float: left; margin-top: 3px;">Titolo:</label>
                                    <input id="titolo" style="float: left; margin-left: 30px;" class="input-xxlarge" type="text" />
                                </div>
                                <br />
                                <br />
                                <div>
                                    <label style="float: left; margin-top: 3px;">Dove:</label>
                                    <!-- <input id="dove" style="float:left; margin-left:30px;" type="text" class="input-xlarge"/>-->
                                    <!--<select id="country" size="1" style="width: 120px; float: left; margin-left: 5px;" onchange="VisualizzaCity();">
                                </select>-->
                                    <input id="country" type="text" placeholder="Nazione" style="float: left; margin-left: 5px;" onblur="VisualizzaCity();" />
                                    <!--<select id="city" size="1" style="width:180px;display:none;float:left;margin-left:5px;" onChange="VisualizzaPlaceName();">-->
                                    <input id="city" type="text" placeholder="Citta" style="display: none; float: left; margin-left: 5px;" onblur="VisualizzaPlaceName();" />
                                    <!--</select>-->
                                    <input id="placeName" type="text" placeholder="Nome del posto" style="width: 200px; display: none; float: left; margin-left: 5px;" />
                                    <br>
                                    <br>
                                    <label style="float: left; margin-top: 3px;">Quando:</label>
                                    <!--<input id="dove" style="float:left; margin-left:3px;" type="text" class="input-xlarge"/>-->
                                    <!--<div style="float:left; margin-left:15px;">
                                  <input id="quando" value="10/10/2011" />
                                </div>-->
                                    <select id="decade" size="1" style="width: 90px; float: left; margin-left: 5px;" onchange="VisualizzaYear();"></select>
                                    <!--<input id="year" value=""/>-->
                                    <select id="year" size="1" style="width: 80px; display: none; float: left; margin-left: 5px;" onchange="VisualizzaMonth();"></select>
                                    <select id="month" size="1" style="width: 120px; display: none; float: left; margin-left: 5px;" onchange="VisualizzaDay();"></select>
                                    <select id="day" size="1" style="width: 80px; display: none; float: left; margin-left: 5px;"></select>
                                    <br>
                                </div>
                            </form>
                        </div>
                        <div style="float: left; margin: 20px;">
                            <!--<button onClick="editor();">Editor</button>-->
                            <input type="image" src="button/buttonFoto.jpg" onclick="capturePhoto();">
                            <br /><br /><br /><br />
                            <input id="record" type="image" style="margin-top: 10px;" src="button/buttonMicrofono.jpg" onclick="captureAudio();">
                            <br /><br /><br /><br />
                            <h3 style="color: #FF0;" id="time">0:00</h3>
                            <input id="play" type="image" style="margin-top: 10px; visibility: hidden;" src="button/buttonPlay.png" onclick="play();">
                            <input id="stop" type="image" style="margin-top: 10px; margin-left: 2px; visibility: hidden;" src="button/buttonStop.png" onclick="stop();">
                        </div>
                        <div style="float: left; margin-right: 20px; width: 300px; text-align: center;">
                            <span class="btn btn-success fileinput-button">
                                <i class="icon-plus icon-white"></i><span>Carica immagini...</span>
                                <!-- The file input field used as target for the file upload widget -->
                                <input id="fileupload" type="file" name="files[]" multiple>
                            </span>
                            <br>
                            <br>
                            <div id="progress" class="progress progress-success progress-striped">
                                <div class="bar"></div>
                            </div>
                            <div id="imgInput" style="overflow: auto; height: 400px;">
                                <br /><br />
                                <!--<div style="position: relative; display: inline-block;"><img style=' max-height:200px;max-width:220px;' src='img/comera2.jpg' /><img src='images/Ximm.png' style='position:absolute;right:-12.5px; top:-12.5px;  cursor:pointer;' /></div><br><br>
                                <div style="position: relative; display: inline-block; "> <img style=' max-height:200px;max-width:220px;' src='img/comera1.jpg' /><img src='images/Ximm.png' style='position: absolute; right: -12.5px; top: -12.5px; cursor: pointer; ' /></div><br><br>-->
                            </div>
                        </div>
                        <textarea id="editor" rows="10" cols="30" style="width: 480px; height: 485px; float: left;"></textarea>

                    </div>
                    <img src="images/X.png" class="chiudi" />
                </div>
            </div>
            <!--fine box-->
            <!--<button onClick="storage();">Storage</button>-->
            <!--<label id="debug"></label>-->
            <div class="overlay" id="overlayCaricamento" style="display: none;"></div>
            <img src="images/caricamento.gif" id="caricamento" />
        </div>
     
    
    <script>
        function onLoad() {
            document.addEventListener("deviceready", onDeviceReady, true);
        }
        function onDeviceReady() {
            console.log("PhoneGap is working!!");
            pictureSource = navigator.camera.PictureSourceType;
            destinationType = navigator.camera.DestinationType;
        }
        function editor() {
            var editor = $("#editor").data("kendoEditor");
            //alert(editor.value());
            $("#debug").text(editor.value());
        }
        /*function storage() {
           /*var storage =$.localStorage;
           //alert(storage.get('prova'));
           //var obj = JSON.parse(storage.get('prova'));
           alert(storage.get('prova').titolo);
           //$("#debug").text(storage.get('prova'));*/


        //EliminaIntestazioneDataImg();

        //alert();
        //}


        var tokern;
        var Context = new Object;
        var MieStorie = new Object;
        var NumeroPaginaMieStorie = 0;
        var NumeroPaginaMieFoto = 0;
        var decade;
        var MieStorieVisible = [];
        var ContextVisible = new Object;
        var sessionKey;
        var personId;
        var imgStoriaUrl = [];
        var imgStoriaUrlHtml = [];
        var imgStoriaHashcode = [];
        var imgStoriaFilename = [];
        var firstDeacade;
        var personalQuestion = [];
        var decadeQuestion = [];
        var decadeSelect = "";
        var yearSelect = "";
        var monthSelect = "";
        var daySelect = "";
        var countrySelect = "";
        var placeNameSelect = "";
        var citySelect = "";
        var vettIndexMieStorieVisible = [];
        var vettIndexFotoContextVisible = [];
        var cities = [];
        var isModify = false;
        var idStoryModify = null;
        var indexModify;
        var idContextRaccontaci = null;
        var birthYear;
        var isFirstOpen = true;

        //statistiche
        var indexCarouselFoto = 0;
        var indexCarouselStorie = 0;
        var indexCarouselCanzoni = 0;
        var indexCarouselTv = 0;
        var indexCarouselFamosi = 0;
        var views = {};
        var detailViews = {};

        function statisticheDETAILVIEWS(publicMementoId)
        {
            // instead of calling the service, let's just count in a hash table which we will later send in one post 
            if (detailViews[publicMementoId]==null) {
            	detailViews[publicMementoId]=1;
            } else {
            	detailViews[publicMementoId]++;
            }            
            ///log/DETAILVIEWS/context/{context_id}/memento/{public_memento_id}
            $.ajax({
                  type: "POST",
                  beforeSend: function (request) {
                      request.setRequestHeader("PLAY_SESSION", GetSessionKey());
                  },
                  url: GetBaseUrl() + "/lifeapi/log/DETAILVIEWS/context/" + GetContextId() + "/memento/" + publicMementoId,
                  data: "{}",
                  dataType: "json",
                  contentType: "application/json",
            //      async: false,
                  success: function (data) {
            //          alert("hola");
                  },
                  error: function (data) {
                  alert("Errore nel passaggio di statistiche");
              }
            });
            //$.ajax({
            //      type: "POST",
            //      beforeSend: function (request) {
            //          request.setRequestHeader("PLAY_SESSION", GetSessionKey());
            //      },
            //      url: GetBaseUrl() + "/lifeapi/log/DETAILVIEWS/context/" + GetContextId() + "/memento/" + publicMementoId,
            //      data: "{}",
            //      dataType: "json",
            //      contentType: "application/json",
            //      async: false,
            //      success: function (data) {
            //          alert("hola");
            //      },
            //      error: function (data) {
            //      alert("Errore nel passaggio di statistiche");
            //  }
            //});
        }

        function aggiungiEventoFancyBox() {
            $(".fancyboxFotoContext").fancybox({
                'showCloseButton': false,
                afterLoad: function (current, previous) {
                    //alert(Storie.length);
                    this.title = "<div><h1>" + ContextVisible.picture[vettIndexFotoContextVisible[this.index]].headline + "</h1><h5>" + ContextVisible.picture[vettIndexFotoContextVisible[this.index]].text + "</h5> <span> Ti viene in mente qualcosa? </span> <button class='btn btn-primary' onClick='ApriOverlay(" + ContextVisible.picture[vettIndexFotoContextVisible[this.index]].publicMementoId + ");'>Raccontaci!</button> </div>";
                    statisticheDETAILVIEWS(ContextVisible.picture[vettIndexFotoContextVisible[this.index]].publicMementoId);
                },
                'helpers': {
                    title: { type: 'inside' }
                } // helpers
            });
            $(".fancyboxMieStorie").fancybox({
                'showCloseButton': false,
                afterLoad: function () {
                    this.title = "<div><h1>" + MieStorieVisible[vettIndexMieStorieVisible[this.index]].headline + "</h1><h5>" + MieStorieVisible[vettIndexMieStorieVisible[this.index]].text + "</h5><br>  <button class='btn btn-primary' onClick='ApriOverlayModifica(" + vettIndexMieStorieVisible[this.index] + ");'>Modifica</button></div>";
                    //this.title = "<div><h1>" + "hola" +"</h1> </div>";
                },
                'helpers': {
                    title: { type: 'inside' }
                } // helpers
            });
        }

        /*$(document).ready(function() {
            var cities = [];
            var idCities = [];
            var tmp = $.getJSON('json/cities.json',function(tmp)
            { //return timeline             
                for (var i = 0; i < tmp.length; i++) {
                    //alert(tmp[i].name);
                    cities.push(tmp[i].name);
                    idCities.push(tmp[i].cityId);
                }
                
                $('#dove').autocomplete({
                    source:cities,
                    minLength: 3 
                });     
            
            });
            
        });*/

        function InizializzaValueLocationAndDate() {
            document.getElementById("decade").innerHTML = "";
            var j = 1;
            document.getElementById("decade").innerHTML += "<option value='" + 0 + "'>" + "decade" + "</option>";
            for (var i = 1900; i <= 2020; i = i + 10) {
                document.getElementById("decade").innerHTML += "<option value='" + j + "'>" + i + "</option>";
                j++;
            }

            document.getElementById("country").innerHTML = "";
            document.getElementById("country").innerHTML += "<option value='" + 0 + "'>" + "nazione" + "</option>";
            document.getElementById("country").innerHTML += "<option value='" + 1 + "'>" + "Italia" + "</option>";

            //inizializzo le citta in raccontaci
            /*var tmp = $.getJSON('json/cities.json', function (tmp) { //return timeline                
                for (var i = 0; i < tmp.length; i++) {
                    //alert(tmp[i].name);
                    cities.push(tmp[i].name);
                    //idCities.push(tmp[i].cityId);
                }

                $('#city').autocomplete({
                    source: cities,
                    minLength: 3,
                    messages: {
                        noResults: '',
                        results: function () { }
                    }
                });

            });*/

            //inizializza lista mesi in raccontaci
            document.getElementById("month").innerHTML = "";
            document.getElementById("month").innerHTML += "<option value='" + 0 + "'>" + "mese" + "</option>";
            var tmp = $.getJSON('json/month.json', function (tmp) { //return timeline               
                for (var i = 1; i < tmp.length + 1; i++) {
                    document.getElementById("month").innerHTML += "<option value='" + i + "'>" + tmp[i - 1].name + "</option>";
                }
            });
        }



        $(document).ready(function () {


            InizializzaValueLocationAndDate();

            //gestisco la visualizzazione a seconda della versione della App scelta dall'utente
            if (GetAppVersion() == 1) {
                //non faccio niente
            } else if (GetAppVersion() == 2) {
                //nascondo le domande
                document.getElementById().style.visibility = "hidden";
            } else if (GetAppVersion() == 3) {
                document.getElementById("divRootFotoDelTempo").style.visibility = "hidden";
                document.getElementById("divRootStorieDelTempo").style.visibility = "hidden";
                document.getElementById("Canzoni").style.visibility = "hidden";
                document.getElementById("TvFilm").style.visibility = "hidden";
                document.getElementById("Famosi").style.visibility = "hidden";
            } else {
                document.getElementById("divFirstDecadeQuestionEmpty").style.visibility = "hidden";
                document.getElementById("divSecondDecadeQuestionEmpty").style.visibility = "hidden";
                document.getElementById("divFirstPersonalQuestionEmpty").style.visibility = "hidden";
                document.getElementById("divSecondPersonalQuestionEmpty").style.visibility = "hidden";
                document.getElementById("divDecadeQuestionNotEmpty").style.visibility = "hidden";
                document.getElementById("idPersonalQuestionNotEmpty").style.visibility = "hidden";

                document.getElementById("divRootFotoDelTempo").style.visibility = "hidden";
                document.getElementById("divRootStorieDelTempo").style.visibility = "hidden";
                document.getElementById("Canzoni").style.visibility = "hidden";
                document.getElementById("TvFilm").style.visibility = "hidden";
                document.getElementById("Famosi").style.visibility = "hidden";
            }

            //var storage =$.localStorage;
            sessionKey = GetSessionKey();
            personId = GetPersonId();
            birthYear = GetPersonYearBirthDate();

            $.ajaxSetup({
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("PLAY_SESSION", sessionKey);
                }
            });
            //alert(birthYear);
            //alert(personId);
            //alert(sessionKey);        

            //decade = 1940;
            decade = GetPersonDeacadeBirthDate();
            //alert(decade);
            $("#lbldebug").text("Non ci sono ancora storie del " + decade + "!");
            $("#FotoDelTempo").text("Foto pubbliche attorno al " + decade);
            $("#TueFotoDelTempo").text("Le tue foto attorno al " + decade);
            $("#StorieDelTempo").text("Che cosa succedeva nel " + decade);
            $("#TueStorieDelTempo").text("Le tue storie nel " + decade);



                      

            

            //Login();
            Timeline();
            ContextFunction();

            //firstDecade = GetFirstDecade(GetPersonDeacadeBirthDate()); //recupero la prima decade che compare nella timeline (guardo la prima che ha una storia raccontata)
            //alert(firstDecade);

            //CreaTimelineCarousel(firstDecade);
            

            //decade = firstDeacade;
            //downloadQuestion(birthYear, decade);

            //GestioneSchermate(firstDecade);
        });





        function YearToDecade(anno) {
            var tmp = anno / 10;
            //alert(parseInt(tmp));
            return parseInt(tmp) * 10;
        }

        function VisualizzaYear() {
            //alert(document.getElementById("decade").item(document.getElementById("decade").value).text);
            //alert(document.getElementById("decade").value);
            if (document.getElementById("decade").value != 0) {
                document.getElementById("year").innerHTML = "";
                decadeSelect = parseInt(document.getElementById("decade").item(document.getElementById("decade").value).text);
                var j = 1;
                document.getElementById("year").innerHTML += "<option value='" + 0 + "'>" + "anno" + "</option>";
                for (var i = decadeSelect; i <= decadeSelect + 9; i++) {
                    document.getElementById("year").innerHTML += "<option value='" + j + "'>" + i + "</option>";
                    j++;
                }
                $('#year').fadeIn('slow');
            }
        }

        function VisualizzaMonth() {
            //alert(document.getElementById("decade").item(document.getElementById("decade").value).text);
            if (document.getElementById("year").value != 0) {
                yearSelect = parseInt(document.getElementById("year").item(document.getElementById("year").value).text);
                $('#month').fadeIn('slow');
            }
        }

        function VisualizzaDay() {
            //alert(document.getElementById("decade").item(document.getElementById("decade").value).text);
            if (document.getElementById("month").value != 0) {
                document.getElementById("day").innerHTML = "";
                monthSelect = parseInt(document.getElementById("month").value);
                var j = 1;
                document.getElementById("day").innerHTML += "<option value='" + 0 + "'>" + "giorno" + "</option>";
                /*for(var i = 1;i <= 31;i++)
                {
                    document.getElementById("day").innerHTML += "<option value='" + i +"'>" + i + "</option>";
                    j++;
                }*/
                switch (monthSelect) {
                    case 1:
                    case 3:
                    case 5:
                    case 7:
                    case 8:
                    case 10:
                    case 12:
                        for (var i = 1; i <= 31; i++) {
                            document.getElementById("day").innerHTML += "<option value='" + i + "'>" + i + "</option>";
                            j++;
                        }
                        break;
                    case 4:
                    case 6:
                    case 9:
                    case 11:
                        for (var i = 1; i <= 30; i++) {
                            document.getElementById("day").innerHTML += "<option value='" + i + "'>" + i + "</option>";
                            j++;
                        }
                        break;
                    case 2:
                        for (var i = 1; i <= 28; i++) {
                            document.getElementById("day").innerHTML += "<option value='" + i + "'>" + i + "</option>";
                            j++;
                        }
                        break;
                }

                $('#day').fadeIn('slow');
            }
        }

        function VisualizzaCity() {
            //if (document.getElementById("country").value != 0) {
            //    //document.getElementById("city").innerHTML = "";
            //    countrySelect = document.getElementById("country").item(document.getElementById("country").value).text;
            //    /*document.getElementById("city").innerHTML += "<option value='" + 0 +"'>" + "citta + "</option>";
            //    var cities = $.getJSON('json/cities.json',function(cities)
            //    { //return timeline
                        
            //        //alert(tmp.length);    
            //        for (var i = 1; i < 40+1; i++) {
            //            document.getElementById("city").innerHTML += "<option value='" + i +"'>" + cities[i-1].name + "</option>";
            //        }
            //    });*/
            //    $('#city').fadeIn('slow');
            //}

            countrySelect = $("#country").val();
            $('#city').fadeIn('slow');
        }

        function ControllaEsistenzaCitta() {
            for (var i = 0; i < cities.length; i++) {
                if ($("#city").val() == cities[i])
                    return true;
            }
            return false;
        }

        function VisualizzaPlaceName() {
            //if (ControllaEsistenzaCitta()) {
            //citySelect = document.getElementById("city").item(document.getElementById("city").value).text;
            citySelect = $("#city").val();
            $('#placeName').fadeIn('slow');
            //}
        }

        function Prova() {
            //$('#divMieFotoDelTempo').carousel(2);
            //$('centrale').scrollLeft('5000px');
            /*var myCont = document.getElementById ("divRoot");
            myCont.scrollTop += 100;*/
            //alert('ciao');
            //$("#divMieFotoDelTempo").carousel('next');
        }
    </script>
     
     
</body>
</html>
